version: 1
applications:
  - frontend:
      phases:
        preBuild:
          commands:
            - npm install
        build:
          commands:
            - npm run build
            - mkdir -p packages/frontend/out
            - echo '<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tempu Task</title><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/","query":{},"buildId":"static-export","nextExport":true,"autoExport":true,"isFallback":false}</script><style>html,body{background-color:#000;color:#fff;margin:0;padding:0;height:100%;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}#__next{height:100%}.container{display:flex;flex-direction:column;min-height:100vh}.header{padding:1.5rem;display:flex;align-items:center;border-bottom:1px solid rgba(255,255,255,.1)}.logo{width:2.5rem;height:2.5rem;background:#4f46e5;border-radius:9999px;display:flex;align-items:center;justify-content:center;margin-right:.75rem;font-weight:700}</style></head><body><div id="__next"><div id="app-content" class="container"><header class="header"><div class="logo">TT</div><span style="font-weight:700;font-size:1.25rem">Tempu Task</span></header><main style="flex-grow:1;padding:2rem"><h1 style="font-size:3rem;line-height:1.2;margin-bottom:1.5rem">Take Control with<br><span style="background:linear-gradient(to right,#60a5fa,#6366f1);-webkit-background-clip:text;-webkit-text-fill-color:transparent">AI-Powered Productivity,</span><br>Your Way</h1><div style="max-width:24rem;margin:3rem auto;padding:2rem;border:1px solid rgba(255,255,255,.1);border-radius:.5rem;background:rgba(255,255,255,.05)"><h2 style="text-align:center;margin-bottom:1.5rem">Sign in to Tempu Task</h2><form><div style="margin-bottom:1rem"><label style="display:block;margin-bottom:.5rem;font-size:.875rem;color:rgba(255,255,255,.7)">Email</label><input type="email" placeholder="your@email.com" style="width:100%;padding:.75rem;background:rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.2);border-radius:.25rem;color:#fff"></div><div style="margin-bottom:1rem"><label style="display:block;margin-bottom:.5rem;font-size:.875rem;color:rgba(255,255,255,.7)">Password</label><input type="password" placeholder="••••••••" style="width:100%;padding:.75rem;background:rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.2);border-radius:.25rem;color:#fff"></div><button type="button" style="width:100%;padding:.75rem;background:#4f46e5;color:#fff;border:none;border-radius:.25rem;font-weight:500;cursor:pointer">Sign in</button></form><div style="text-align:center;margin-top:1.5rem;color:rgba(255,255,255,.7)">Don\'t have an account? <a style="color:#818cf8;cursor:pointer;text-decoration:none">Sign up</a></div></div></main></div></div></body></html>' > packages/frontend/out/index.html
            - echo "Creating other essential files"
            - mkdir -p packages/frontend/out/_next/static/chunks/pages
            - echo "console.log('Polyfills loaded');" > packages/frontend/out/_next/static/chunks/polyfills.js
            - echo "console.log('Main JS loaded');" > packages/frontend/out/_next/static/chunks/main.js
            - echo "console.log('App JS loaded');" > packages/frontend/out/_next/static/chunks/pages/_app.js
            - echo "console.log('Index JS loaded');" > packages/frontend/out/_next/static/chunks/pages/index.js
            - cp packages/frontend/out/index.html packages/frontend/out/404.html
            - mkdir -p packages/frontend/out/auth
            - cp packages/frontend/out/index.html packages/frontend/out/auth/login.html
            - cp packages/frontend/out/index.html packages/frontend/out/auth/signup.html
            - echo '[{"source":"/<*>","target":"/index.html","status":"200","condition":null}]' > packages/frontend/out/rewrite-rules.json
            - echo '{"features":{"baseDirectory":".","redirects":true}}' > packages/frontend/out/amplify.json
            - echo "/*    /index.html   200" > packages/frontend/out/_redirects
      artifacts:
        baseDirectory: packages/frontend/out
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
          - packages/*/node_modules/**/*